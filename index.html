<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Explorateur Interactif de l'OWASP Top 10:2021</title>
    <!-- Chosen Palette: Harmonie Sereine (Beige, Ardoise, Bleu Doux, Vert S√ªr, Rouge Alerte) -->
    <!-- Application Structure Plan: L'application utilise une structure de tableau de bord avec une navigation lat√©rale fixe et une zone de contenu dynamique. Cette architecture a √©t√© choisie pour g√©rer la densit√© d'informations du rapport. La navigation lat√©rale offre un acc√®s direct et constant aux 10 vuln√©rabilit√©s et √† la section d'analyse, favorisant une exploration non lin√©aire. La zone de contenu principale utilise un syst√®me d'onglets pour chaque vuln√©rabilit√© (Vue d'ensemble, Exemples de code, Mitigation, Analyse), segmentant l'information en morceaux digestes. Cette approche am√©liore consid√©rablement la convivialit√© par rapport √† un long d√©filement, permettant aux utilisateurs de se concentrer sur des aspects sp√©cifiques (par exemple, comparer uniquement les exemples de code) sans √™tre submerg√©s. -->
    <!-- Visualization & Content Choices: 
        - Rapport Info: Classement OWASP 2017 vs 2021. Goal: Comparer. Viz: Graphique √† barres horizontales group√©es. Interaction: Survol pour afficher des d√©tails sur les changements. Justification: Visualisation directe et efficace des changements de classement, des nouvelles entr√©es et des fusions. Library: Chart.js.
        - Rapport Info: D√©tails de chaque vuln√©rabilit√© (description, causes, impacts). Goal: Informer. Viz: Cartes d'information structur√©es avec des ic√¥nes (Unicode) et du texte. Interaction: Contenu statique mais segment√©. Justification: Pr√©sentation a√©r√©e et visuellement engageante qui met en √©vidence les informations cl√©s. Library: HTML/Tailwind.
        - Rapport Info: Exemples de code vuln√©rable et s√©curis√©. Goal: √âduquer/Comparer. Viz: Blocs de code c√¥te √† c√¥te avec une coloration syntaxique de base via CSS. Interaction: Onglet d√©di√© pour isoler la comparaison de code. Justification: Facilite la compr√©hension des erreurs et des corrections en les pr√©sentant directement en opposition. Library: HTML/CSS.
        - Rapport Info: Strat√©gies de mitigation. Goal: Actionner. Viz: Listes √† puces de type checklist. Interaction: Contenu statique. Justification: Pr√©sente les mesures de d√©fense comme des √©tapes claires et applicables. Library: HTML/Tailwind.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. 
    -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
        background-color: #f8f7f4;
        color: #3d4752;
      }
      .chart-container {
        position: relative;
        width: 100%;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        height: 450px;
        max-height: 60vh;
      }
      @media (max-width: 768px) {
        .chart-container {
          height: 400px;
        }
      }
      .nav-link {
        transition: all 0.2s ease-in-out;
        border-left: 3px solid transparent;
      }
      .nav-link.active {
        background-color: #e9e7e2;
        border-left-color: #60a5fa; /* accent-blue-400 */
        color: #1e3a8a; /* text-blue-900 */
      }
      .nav-link:hover {
        background-color: #e9e7e2;
      }
      .tab-button {
        transition: all 0.2s ease-in-out;
        border-bottom: 2px solid transparent;
      }
      .tab-button.active {
        border-bottom-color: #60a5fa;
        color: #1e3a8a;
      }
      .code-block {
        background-color: #1e293b; /* slate-800 */
        color: #e2e8f0; /* slate-200 */
        padding: 1rem;
        border-radius: 0.5rem;
        font-family: "Courier New", Courier, monospace;
        font-size: 0.875rem;
        line-height: 1.5;
        overflow-x: auto;
      }
      .code-block .comment {
        color: #64748b;
      } /* slate-500 */
      .code-block .keyword {
        color: #f472b6;
      } /* pink-400 */
      .code-block .string {
        color: #a7f3d0;
      } /* emerald-200 */
      .code-block .class-name {
        color: #67e8f9;
      } /* cyan-300 */
      .content-fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body class="min-h-screen">
    <div class="flex flex-col md:flex-row min-h-screen">
      <aside
        class="w-full md:w-64 lg:w-72 bg-white/50 backdrop-blur-sm border-r border-gray-200/80 p-4 shrink-0"
      >
        <h1 class="text-xl font-bold text-blue-900/80 mb-6">OWASP Top 10</h1>
        <nav id="main-nav" class="space-y-1"></nav>
        <div
          class="absolute bottom-0 left-0 right-0 bg-white/50 backdrop-blur-sm border-t border-gray-200/80 p-4 text-center text-sm text-gray-600"
        >
          &copy; 2025 Andomahefa Julio Rakotomalala. All rights reserved.
        </div>
      </aside>

      <main
        id="main-content"
        class="flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto"
      ></main>
    </div>

    <script>
      const owaspData = {
        introduction: {
          title: "Bienvenue dans l'Explorateur Interactif OWASP Top 10",
          content: `
            <div class="prose max-w-none">
                <p class="text-lg">Cette application est une adaptation interactive du rapport d'expert sur les risques de s√©curit√© des applications web de l'OWASP Top 10 pour 2021. L'OWASP Top 10 est un document de sensibilisation reconnu mondialement qui repr√©sente un consensus sur les risques de s√©curit√© les plus critiques.</p>
                <p>Utilisez la navigation sur la gauche pour explorer en profondeur chaque vuln√©rabilit√©. Chaque section contient une description d√©taill√©e, des exemples de code concrets pour illustrer les failles et leurs corrections, des strat√©gies de mitigation claires et une analyse approfondie des tendances et des implications.</p>
                <div class="mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                    <h3 class="text-lg font-semibold text-blue-800">Comment utiliser cet outil :</h3>
                    <ul class="list-disc list-inside mt-2 space-y-1">
                        <li><strong>Navigation :</strong> Cliquez sur une vuln√©rabilit√© (A01 √† A10) ou sur "√âvolution 2017-2021" dans le menu.</li>
                        <li><strong>Onglets :</strong> Dans chaque section de vuln√©rabilit√©, utilisez les onglets pour basculer entre la vue d'ensemble, les exemples de code, les strat√©gies de mitigation et l'analyse.</li>
                        <li><strong>Interactivit√© :</strong> Survolez les barres du graphique d'√©volution pour obtenir des informations contextuelles.</li>
                    </ul>
                </div>
            </div>
        `,
        },
        evolution: {
          title: "√âvolution de l'OWASP Top 10 : 2017 vs 2021",
          content: `
            <div class="prose max-w-none">
                <p>L'OWASP Top 10 est un document dynamique qui refl√®te l'√©volution du paysage des menaces. La version 2021 a introduit des changements significatifs par rapport √† 2017, notamment de nouvelles cat√©gories comme la "Conception Dangereuse" et le "SSRF", et la consolidation d'autres comme l'injection et le XSS. Ce graphique illustre les changements de classement et la structure des cat√©gories entre les deux versions.</p>
            </div>
            <div class="mt-8 chart-container">
                <canvas id="evolutionChart"></canvas>
            </div>
        `,
        },
        A01: {
          id: "A01:2021",
          name: "Contr√¥le d'Acc√®s D√©faillant",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Le contr√¥le d'acc√®s d√©faillant se classe au premier rang car 94% des applications test√©es pr√©sentaient une forme de cette vuln√©rabilit√©. Il se produit lorsque les restrictions sur ce que les utilisateurs authentifi√©s sont autoris√©s √† faire ne sont pas correctement appliqu√©es. Les attaquants peuvent exploiter ces failles pour acc√©der √† des fonctionnalit√©s et/ou des donn√©es non autoris√©es, telles que l'acc√®s aux comptes d'autres utilisateurs, la visualisation de fichiers sensibles, la modification des donn√©es d'autres utilisateurs, la modification des droits d'acc√®s, etc.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Violation du principe du moindre privil√®ge.</li>
                                <li>Contournement des v√©rifications en modifiant l'URL, l'√©tat interne, etc.</li>
                                <li>R√©f√©rences directes d'objets non s√©curis√©es (IDOR).</li>
                                <li>Permissions d'API manquantes pour POST, PUT, DELETE.</li>
                                <li>√âl√©vation de privil√®ges.</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Divulgation, modification ou destruction non autoris√©e de toutes les donn√©es.</li>
                                <li>Ex√©cution de fonctions m√©tier hors des limites de l'utilisateur.</li>
                                <li>Prise de contr√¥le de compte ou du site complet.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">L'exemple le plus courant de contr√¥le d'acc√®s d√©faillant est la r√©f√©rence directe d'objet non s√©curis√©e (IDOR). L'application utilise une entr√©e fournie par l'utilisateur pour acc√©der directement √† un objet en base de donn√©es sans v√©rifier si l'utilisateur est autoris√© √† y acc√©der.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Code Vuln√©rable (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// L'application r√©cup√®re un compte via l'URL sans v√©rifier les droits</span>
<span class="keyword">public void</span> <span class="function">doGet</span>(HttpServletRequest request, ...) {
    String accountId = request.getParameter(<span class="string">"accountId"</span>);
    
    <span class="comment">// ATTENTION: Aucune v√©rification pour savoir si l'utilisateur
    // authentifi√© est le propri√©taire du compte 'accountId'.</span>
    User accountInfo = userService.getAccountDetails(accountId);
    
    <span class="comment">// Affiche les infos, m√™me si elles appartiennent √† un autre utilisateur.</span>
}</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Code S√©curis√© (Java avec Spring Security)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Le contr√¥leur v√©rifie la propri√©t√© du compte</span>
@GetMapping(<span class="string">"/{accountId}"</span>)
<span class="keyword">public</span> ResponseEntity&lt;User&gt; getAccountDetails(
        @PathVariable String accountId, Principal principal) {
    
    <span class="comment">// R√©cup√®re l'ID de l'utilisateur authentifi√©</span>
    String authenticatedUserId = principal.getName();

    <span class="comment">// V√âRIFICATION: Compare l'ID demand√© √† l'ID authentifi√©</span>
    <span class="keyword">if</span> (!accountId.equals(authenticatedUserId)) {
        <span class="keyword">return new</span> ResponseEntity&lt;&gt;(HttpStatus.FORBIDDEN);
    }
    
    User accountInfo = userService.getAccountDetails(accountId);
    <span class="keyword">return new</span> ResponseEntity&lt;&gt;(accountInfo, HttpStatus.OK);
}</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Refuser par d√©faut :</strong> Impl√©mentez des m√©canismes de contr√¥le d'acc√®s une seule fois et r√©utilisez-les dans toute l'application, en refusant tout acc√®s par d√©faut.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Centraliser les contr√¥les :</strong> Mod√©lisez les contr√¥les d'acc√®s pour imposer la propri√©t√© des enregistrements, plut√¥t que d'accepter que l'utilisateur puisse cr√©er, lire, mettre √† jour ou supprimer n'importe quel enregistrement.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Invalider les jetons :</strong> Invalidez les jetons JWT c√¥t√© serveur apr√®s la d√©connexion.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Limiter le d√©bit :</strong> Limitez le d√©bit des requ√™tes API pour minimiser les dommages caus√©s par les outils automatis√©s.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Journaliser les √©checs :</strong> Enregistrez les √©checs de contr√¥le d'acc√®s et alertez les administrateurs lorsque cela est appropri√©.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>L'ascension du Contr√¥le d'Acc√®s D√©faillant √† la premi√®re place souligne une √©volution significative de la complexit√© des applications. Ce n'est plus seulement une question d'erreurs de codage isol√©es, mais de la mani√®re dont les autorisations sont g√©r√©es √† travers des architectures distribu√©es (API, microservices). La pr√©valence des vuln√©rabilit√©s IDOR est un exemple frappant. Les d√©veloppeurs supposent souvent √† tort que l'authentification implique l'autorisation, menant √† des failles de conception o√π la confiance dans les entr√©es client n'est pas v√©rifi√©e c√¥t√© serveur. Cela exige une mentalit√© de "refus par d√©faut" et des cadres de contr√¥le d'acc√®s plus robustes et centralis√©s.</p>
                `,
            },
          },
        },
        A02: {
          id: "A02:2021",
          name: "D√©faillances Cryptographiques",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Pr√©c√©demment "Exposition de Donn√©es Sensibles", cette cat√©gorie monte en deuxi√®me position et se concentre sur les d√©faillances li√©es √† la cryptographie. Elle concerne souvent des donn√©es qui devraient √™tre prot√©g√©es, comme les mots de passe, les num√©ros de carte de cr√©dit, les dossiers de sant√©, les informations personnelles et les secrets d'entreprise. Les failles peuvent inclure la transmission de donn√©es en clair, l'utilisation d'algorithmes faibles ou obsol√®tes, ou une mauvaise gestion des cl√©s.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Stockage ou transmission de donn√©es en clair (HTTP, SMTP, FTP).</li>
                                <li>Algorithmes cryptographiques anciens ou faibles (MD5, SHA-1).</li>
                                <li>Mauvaise gestion des cl√©s (cl√©s cod√©es en dur, stockage non s√©curis√©).</li>
                                <li>Hachage de mot de passe faible (sans sel).</li>
                                <li>G√©n√©ration de nombres al√©atoires non s√©curis√©e.</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Amendes r√©glementaires importantes (RGPD, HIPAA).</li>
                                <li>Vol d'identit√© et fraude.</li>
                                <li>Compromission de syst√®mes entiers.</li>
                                <li>Perte de r√©putation et de confiance des clients.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">Un exemple classique est le stockage de mots de passe en utilisant un algorithme de hachage faible et non sal√©. Cela rend les mots de passe stock√©s vuln√©rables aux attaques par force brute et par tables arc-en-ciel si la base de donn√©es est compromise.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Code Vuln√©rable (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Hachage de mot de passe avec SHA-1 (faible et non sal√©)</span>
<span class="keyword">public static</span> String <span class="function">hashPassword</span>(String password) {
    <span class="keyword">try</span> {
        MessageDigest md = MessageDigest.getInstance(<span class="string">"SHA-1"</span>);
        <span class="keyword">byte</span>[] hashedPassword = md.digest(password.getBytes());
        <span class="comment">// Ce hachage est facilement cassable</span>
        <span class="keyword">return</span> Base64.getEncoder().encodeToString(hashedPassword);
    } <span class="keyword">catch</span> (NoSuchAlgorithmException e) {
        <span class="keyword">throw new</span> RuntimeException(e);
    }
}</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Code S√©curis√© (Java avec BCrypt)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Hachage fort, adaptatif et sal√© avec BCrypt</span>
<span class="keyword">public static</span> String <span class="function">hashPassword</span>(String password) {
    BCryptPasswordEncoder passwordEncoder = 
        <span class="keyword">new</span> <span class="class-name">BCryptPasswordEncoder</span>();
    
    <span class="comment">// BCrypt g√®re automatiquement le salage et est lent
    // par conception pour r√©sister √† la force brute.</span>
    <span class="keyword">return</span> passwordEncoder.encode(password);
}

<span class="keyword">public static boolean</span> <span class="function">verifyPassword</span>(String raw, String encoded) {
    BCryptPasswordEncoder passwordEncoder = 
        <span class="keyword">new</span> <span class="class-name">BCryptPasswordEncoder</span>();
    <span class="keyword">return</span> passwordEncoder.matches(raw, encoded);
}</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Classifier les donn√©es :</strong> Identifiez les donn√©es sensibles et ne les stockez pas inutilement.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Chiffrer au repos et en transit :</strong> Utilisez des algorithmes robustes pour chiffrer les donn√©es stock√©es et TLS 1.2+ avec HSTS pour les donn√©es en transit.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser un hachage fort :</strong> Stockez les mots de passe avec des fonctions de hachage robustes, adaptatives et sal√©es comme Argon2, scrypt ou BCrypt.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>G√©rer les cl√©s correctement :</strong> Assurez une gestion des cl√©s s√©curis√©e et ne codez jamais les cl√©s en dur.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>√âviter les algorithmes obsol√®tes :</strong> N'utilisez pas de fonctions cryptographiques d√©pr√©ci√©es comme MD5, SHA1 ou PKCS#1 v1.5.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>Le renommage en "D√©faillances Cryptographiques" souligne que le probl√®me n'est pas seulement la pr√©sence de donn√©es sensibles, mais l'√©chec de leur protection. La simple utilisation du chiffrement est insuffisante; la qualit√© et l'application correcte des principes cryptographiques sont primordiales. La persistance de l'utilisation de hachages faibles, malgr√© l'existence de solutions robustes et bien document√©es comme BCrypt, met en lumi√®re une lacune dans l'√©ducation des d√©veloppeurs et une adh√©sion insuffisante aux meilleures pratiques, souvent √† cause de syst√®mes h√©rit√©s ou d'un manque de sensibilisation.</p>
                `,
            },
          },
        },
        A03: {
          id: "A03:2021",
          name: "Injection",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Les failles d'injection descendent √† la troisi√®me position. 94% des applications ont √©t√© test√©es pour une forme d'injection. Cette cat√©gorie inclut d√©sormais le Cross-Site Scripting (XSS). Une faille d'injection se produit lorsqu'une application inclut des donn√©es non fiables dans une commande ou une requ√™te. Les donn√©es hostiles de l'attaquant peuvent tromper l'interpr√©teur pour qu'il ex√©cute des commandes non intentionnelles ou acc√®de √† des donn√©es sans autorisation appropri√©e.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Types d'Injection</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Injection SQL (SQLi)</li>
                                <li>Cross-Site Scripting (XSS)</li>
                                <li>Injection de commandes OS</li>
                                <li>Injection NoSQL</li>
                                <li>Injection LDAP</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Perte ou corruption de donn√©es, voire prise de contr√¥le du syst√®me.</li>
                                <li>D√©tournement de session utilisateur (via XSS).</li>
                                <li>Exfiltration de donn√©es sensibles.</li>
                                <li>D√©figuration de sites web et atteinte √† la r√©putation.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">L'injection SQL est un exemple classique. Elle se produit lorsque l'entr√©e utilisateur est directement concat√©n√©e dans une cha√Æne de requ√™te SQL, permettant √† un attaquant de manipuler la requ√™te.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Code Vuln√©rable (Java - SQLi)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Concat√©nation de cha√Æne directe</span>
String userId = request.getParameter(<span class="string">"id"</span>);
String query = <span class="string">"SELECT * FROM accounts WHERE custID = '"</span> + userId + <span class="string">"'"</span>;

<span class="comment">// Si userId est "1' OR '1'='1", la requ√™te renvoie tout.</span>
Statement stmt = connection.createStatement();
ResultSet rs = stmt.executeQuery(query);</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Code S√©curis√© (Java - PreparedStatement)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Utilisation de requ√™tes param√©tr√©es (prepared statements)</span>
String userId = request.getParameter(<span class="string">"id"</span>);
String query = <span class="string">"SELECT * FROM accounts WHERE custID = ?"</span>;

PreparedStatement pstmt = connection.prepareStatement(query);
<span class="comment">// L'entr√©e est trait√©e comme donn√©e, pas comme code.</span>
pstmt.setString(1, userId);

ResultSet rs = pstmt.executeQuery();</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>S√©parer les donn√©es des commandes :</strong> La m√©thode pr√©f√©r√©e est d'utiliser des API s√ªres qui √©vitent l'interpr√©teur, comme les requ√™tes param√©tr√©es ou les ORM.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Validation d'entr√©e c√¥t√© serveur :</strong> Utilisez une validation positive (liste blanche) pour valider toutes les entr√©es utilisateur.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Encodage de sortie :</strong> Encodez les donn√©es non fiables avant de les afficher pour pr√©venir les attaques XSS, en utilisant un encodage contextuel appropri√©.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser LIMIT :</strong> Limitez le nombre de r√©sultats retourn√©s par les requ√™tes pour emp√™cher la divulgation massive de donn√©es en cas d'injection.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Mettre en place une CSP :</strong> Utilisez une Politique de S√©curit√© de Contenu (Content Security Policy) pour r√©duire la gravit√© des failles XSS.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>La persistance de l'injection, malgr√© des d√©cennies de sensibilisation, est un fait marquant. L'√©largissement de la cat√©gorie pour inclure le XSS renforce l'id√©e que le probl√®me fondamental est le traitement inappropri√© de donn√©es non fiables comme du code ex√©cutable. Cela peut s'expliquer par la complexit√© croissante des applications et une "confiance aveugle" dans les frameworks, qui ne prot√®gent pas toujours par d√©faut. Un besoin continu de formation pratique sur l'√©chappement contextuel et l'utilisation correcte des API s√©curis√©es est essentiel.</p>
                `,
            },
          },
        },
        A04: {
          id: "A04:2021",
          name: "Conception Dangereuse",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">C'est une nouvelle cat√©gorie pour 2021, qui se concentre sur les risques li√©s aux d√©fauts de conception et d'architecture. Elle repr√©sente un appel √† utiliser davantage la mod√©lisation des menaces, les mod√®les de conception s√©curis√©s et les architectures de r√©f√©rence. Une conception non s√©curis√©e ne peut pas √™tre corrig√©e par une impl√©mentation parfaite. Si les contr√¥les de s√©curit√© n√©cessaires n'ont jamais √©t√© con√ßus, un code impeccable ne pourra pas compenser cette lacune.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Exemples de Conception Dangereuse</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Processus de r√©cup√©ration de mot de passe bas√© sur des questions secr√®tes.</li>
                                <li>Manque de protection contre les attaques automatis√©es (bots).</li>
                                <li>Absence de limitation de d√©bit pour les fonctions critiques.</li>
                                <li>Privil√®ges excessifs accord√©s aux utilisateurs de base de donn√©es.</li>
                                <li>Logique m√©tier d√©faillante qui peut √™tre exploit√©e (ex: achats illimit√©s).</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Pertes financi√®res massives.</li>
                                <li>Compromission de comptes √† grande √©chelle.</li>
                                <li>D√©ni de service (DoS) par √©puisement des ressources.</li>
                                <li>Atteinte grave √† la r√©putation de la marque.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">La conception dangereuse est moins une question de code qu'une question de logique et d'architecture. Il n'y a pas de "code vuln√©rable" typique, mais plut√¥t l'absence de code ou de contr√¥les l√† o√π ils devraient √™tre. L'exemple ci-dessous est conceptuel.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Conception Vuln√©rable (Logique)</h4>
                            <div class="p-4 bg-red-50 rounded-lg border border-red-200">
                                <p class="font-mono text-sm">
                                    <strong>Sc√©nario :</strong> Un site de cin√©ma permet de r√©server des places.
                                    <br><br>
                                    <strong>Faille de conception :</strong> Il n'y a pas de limite au nombre de places qu'un utilisateur peut r√©server en une seule transaction, et aucun contr√¥le sur la fr√©quence des r√©servations.
                                    <br><br>
                                    <strong>Attaque :</strong> Un bot peut r√©server toutes les places pour toutes les s√©ances en quelques secondes, cr√©ant un d√©ni de service pour les utilisateurs l√©gitimes et permettant √† l'attaquant de revendre les places.
                                </p>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Conception S√©curis√©e (Logique)</h4>
                            <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                                <p class="font-mono text-sm">
                                    <strong>Sc√©nario :</strong> Le m√™me site de cin√©ma.
                                    <br><br>
                                    <strong>Conception robuste :</strong>
                                    <ul class="list-disc list-inside mt-2">
                                        <li><strong>Limitation de d√©bit :</strong> Un utilisateur ne peut faire qu'une r√©servation toutes les 30 secondes.</li>
                                        <li><strong>Logique m√©tier :</strong> Le nombre de places par transaction est limit√© √† 10.</li>
                                        <li><strong>Protection anti-bot :</strong> Un CAPTCHA est d√©clench√© apr√®s 3 tentatives de r√©servation infructueuses.</li>
                                    </ul>
                                </p>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Adopter un SDLC s√©curis√© :</strong> Int√©grez la s√©curit√© √† chaque √©tape du cycle de vie du d√©veloppement.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser la mod√©lisation des menaces :</strong> Analysez les flux de travail critiques pour identifier les failles de conception potentielles.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser des mod√®les de conception s√©curis√©s :</strong> √âtablissez une biblioth√®que de composants et de mod√®les de conception s√©curis√©s et pr√™ts √† l'emploi.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Impl√©menter des v√©rifications de plausibilit√© :</strong> Validez la logique m√©tier √† chaque niveau de l'application.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>S√©gr√©ger les couches :</strong> S√©parez les couches de l'application en fonction des besoins de protection et de l'exposition.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>L'introduction de la "Conception Dangereuse" est un tournant. Elle affirme qu'une "conception non s√©curis√©e ne peut pas √™tre corrig√©e par une impl√©mentation parfaite", d√©pla√ßant une partie de la responsabilit√© de la s√©curit√© des d√©veloppeurs vers les architectes logiciels et les chefs de projet. Cela met en lumi√®re la n√©cessit√© d'int√©grer la mod√©lisation des menaces et les principes de "secure by design" d√®s le d√©but d'un projet. Le co√ªt de la correction d'une faille de conception augmentant de mani√®re exponentielle avec le temps, une approche proactive est non seulement plus s√ªre, mais aussi plus rentable.</p>
                `,
            },
          },
        },
        A05: {
          id: "A05:2021",
          name: "Mauvaise Configuration de S√©curit√©",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Cette cat√©gorie monte de la 6√®me √† la 5√®me position et inclut d√©sormais la vuln√©rabilit√© XML External Entities (XXE) de 2017. Elle r√©sulte de l'oubli de durcir suffisamment la s√©curit√© de toute partie de la pile applicative ou de la mauvaise configuration des permissions sur les services cloud. Elle est souvent le r√©sultat d'erreurs humaines, de l'acceptation des configurations par d√©faut ou de l'absence de processus de durcissement standardis√©s.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Fonctionnalit√©s, ports, services ou comptes inutiles activ√©s.</li>
                                <li>Comptes par d√©faut avec mots de passe inchang√©s.</li>
                                <li>Messages d'erreur trop verbeux (traces de pile).</li>
                                <li>Permissions cloud mal configur√©es (ex: buckets S3 publics).</li>
                                <li>Listage de r√©pertoires activ√© sur le serveur web.</li>
                                <li>En-t√™tes de s√©curit√© HTTP manquants ou mal configur√©s.</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Acc√®s non autoris√© au syst√®me.</li>
                                <li>Fuite de donn√©es sensibles.</li>
                                <li>Ex√©cution de code √† distance (via XXE).</li>
                                <li>Cartographie compl√®te du syst√®me de fichiers et du r√©seau interne.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">La mauvaise configuration est souvent dans les fichiers de configuration plut√¥t que dans le code applicatif. Un exemple classique est d'autoriser le listage des r√©pertoires sur un serveur web, ce qui peut exposer la structure de l'application et des fichiers sensibles.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Configuration Vuln√©rable (Apache Tomcat web.xml)</h4>
                            <div class="code-block">
                                <pre><code>&lt;servlet&gt;
    &lt;servlet-name&gt;default&lt;/servlet-name&gt;
    &lt;servlet-class&gt;...DefaultServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;listings&lt;/param-name&gt;
        <span class="comment">&lt;!-- 'true' active le listage de r√©pertoire --&gt;</span>
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/servlet&gt;</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Configuration S√©curis√©e (Apache Tomcat web.xml)</h4>
                            <div class="code-block">
                                <pre><code>&lt;servlet&gt;
    &lt;servlet-name&gt;default&lt;/servlet-name&gt;
    &lt;servlet-class&gt;...DefaultServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;listings&lt;/param-name&gt;
        <span class="comment">&lt;!-- 'false' d√©sactive le listage de r√©pertoire --&gt;</span>
        &lt;param-value&gt;false&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/servlet&gt;</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Processus de durcissement :</strong> √âtablissez un processus r√©p√©table et automatis√© pour durcir les configurations de tous les environnements.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Surface d'attaque minimale :</strong> D√©sactivez ou supprimez toutes les fonctionnalit√©s, ports, services et comptes inutiles.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Automatiser la configuration :</strong> Utilisez des outils d'Infrastructure as Code (IaC) pour automatiser et valider les configurations de mani√®re coh√©rente.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Configurer les en-t√™tes de s√©curit√© :</strong> Assurez-vous que les en-t√™tes HTTP de s√©curit√© (HSTS, CSP, etc.) sont pr√©sents et correctement configur√©s.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>G√©rer les erreurs :</strong> Configurez des pages d'erreur personnalis√©es pour ne pas divulguer d'informations sensibles comme les traces de pile.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>L'augmentation de cette cat√©gorie refl√®te la complexit√© croissante des environnements modernes (cloud, conteneurs, microservices) o√π les points de configuration sont multiples et faciles √† n√©gliger. La cause principale est souvent l'erreur humaine ou le manque de surveillance. La contradiction entre s√©curit√© et convivialit√© est pertinente ici; des contr√¥les peuvent √™tre d√©sactiv√©s pour des raisons de commodit√©. Cela souligne l'urgence d'automatiser la gestion des configurations (IaC) et d'adopter une approche "s√©curis√©e par d√©faut" pour que les configurations de base soient s√ªres d√®s le d√©part.</p>
                `,
            },
          },
        },
        A06: {
          id: "A06:2021",
          name: "Composants Vuln√©rables et Obsol√®tes",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Cette cat√©gorie monte √† la 6√®me position et concerne les risques li√©s √† l'utilisation de d√©pendances (biblioth√®ques, frameworks) tierces ou open source qui ont des vuln√©rabilit√©s connues. Le d√©veloppement logiciel moderne repose massivement sur ces composants, cr√©ant une "cha√Æne d'approvisionnement logicielle" qui doit √™tre s√©curis√©e. Les composants s'ex√©cutent g√©n√©ralement avec les m√™mes privil√®ges que l'application, donc une faille dans un composant peut avoir des cons√©quences d√©sastreuses.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Manque d'inventaire des composants et de leurs versions.</li>
                                <li>Utilisation de logiciels non pris en charge, obsol√®tes ou non patch√©s.</li>
                                <li>Absence de scan r√©gulier des vuln√©rabilit√©s (SCA).</li>
                                <li>D√©lais trop longs pour appliquer les correctifs de s√©curit√©.</li>
                                <li>Obtention de composants depuis des sources non fiables.</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Ex√©cution de code √† distance (RCE), comme avec Log4Shell ou Struts.</li>
                                <li>Fuites de donn√©es massives et br√®ches de conformit√©.</li>
                                <li>Prise de contr√¥le compl√®te du serveur ou de l'application.</li>
                                <li>Dommages importants √† la r√©putation et √† la confiance.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="mt-4 p-4 bg-gray-100 rounded-lg">
                        <h4 class="font-semibold">Exemple notoire : Log4Shell (CVE-2021-44228)</h4>
                        <p class="text-sm mt-2">Une vuln√©rabilit√© critique dans la biblioth√®que de journalisation Java Log4j, largement utilis√©e, permettait l'ex√©cution de code √† distance non authentifi√©e via une simple cha√Æne de caract√®res dans un log. Cet incident a mis en √©vidence la d√©pendance syst√©mique √† des composants open source et l'impact catastrophique qu'une seule faille peut avoir sur l'√©cosyst√®me mondial.</p>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">Cette vuln√©rabilit√© ne se situe pas dans le code que vous √©crivez directement, mais dans les d√©pendances que vous importez. L'exemple ci-dessous illustre comment une version vuln√©rable d'une biblioth√®que est d√©clar√©e dans un projet.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ D√©pendance Vuln√©rable (Maven pom.xml)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">&lt;!-- Exemple avec une version vuln√©rable de Log4j --&gt;</span>
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
    <span class="comment">&lt;!-- Version 2.14.1 et ant√©rieures sont vuln√©rables √† Log4Shell --&gt;</span>
    &lt;version&gt;2.14.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ D√©pendance S√©curis√©e (Maven pom.xml)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">&lt;!-- Mise √† jour vers une version corrig√©e --&gt;</span>
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
    <span class="comment">&lt;!-- Mettre √† jour vers 2.17.1 ou plus r√©cent pour les correctifs --&gt;</span>
    &lt;version&gt;2.17.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Faire un inventaire :</strong> Supprimez les d√©pendances, fonctionnalit√©s, composants, fichiers et documentations inutilis√©s.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Scanner en continu :</strong> Utilisez des outils d'analyse de composition logicielle (SCA) comme OWASP Dependency Check pour identifier en continu les composants vuln√©rables.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser des sources fiables :</strong> Obtenez des composants uniquement depuis des sources officielles et des d√©p√¥ts s√©curis√©s.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Mettre √† jour rapidement :</strong> Maintenez les composants √† jour et appliquez les correctifs de s√©curit√© d√®s qu'ils sont disponibles.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>D√©ployer des patchs virtuels :</strong> Si un patching imm√©diat est impossible, utilisez un pare-feu d'application web (WAF) pour bloquer les tentatives d'exploitation connues.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>L'incident Log4Shell a servi de prise de conscience brutale sur les risques de la cha√Æne d'approvisionnement logicielle. La difficult√© n'est pas seulement de patcher, mais de savoir ce qu'il faut patcher. Les organisations luttent pour maintenir un inventaire complet de leurs d√©pendances, y compris les d√©pendances transitives. Les outils SCA sont devenus indispensables, mais peuvent g√©n√©rer une "fatigue d'alerte". La priorisation bas√©e sur l'exploitabilit√© r√©elle est donc cruciale. La gestion de ce risque exige une approche proactive et continue, avec une visibilit√© et un contr√¥le sur l'ensemble de la cha√Æne d'approvisionnement.</p>
                `,
            },
          },
        },
        A07: {
          id: "A07:2021",
          name: "D√©faillances d'Identification et d'Authentification",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Pr√©c√©demment "Authentification D√©faillante", cette cat√©gorie descend √† la 7√®me place et inclut d√©sormais des CWEs li√©s aux √©checs d'identification. Elle couvre les faiblesses dans la gestion de l'identit√© des utilisateurs, de l'authentification et des sessions. Une gestion correcte de ces aspects est cruciale pour se prot√©ger contre les attaques qui m√®nent √† la prise de contr√¥le de comptes.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Permet les attaques automatis√©es (credential stuffing, force brute).</li>
                                <li>Autorise les mots de passe par d√©faut, faibles ou bien connus.</li>
                                <li>Processus de r√©cup√©ration de mot de passe faibles.</li>
                                <li>Authentification multi-facteurs (MFA) absente ou inefficace.</li>
                                <li>Exposition des identifiants de session dans l'URL.</li>
                                <li>Invalidation incorrecte de la session apr√®s d√©connexion.</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Prise de contr√¥le de comptes utilisateurs ou administrateurs.</li>
                                <li>Acc√®s non autoris√© √† des donn√©es sensibles.</li>
                                <li>D√©tournement de session.</li>
                                <li>Fraude et pertes financi√®res.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">Une faille classique de gestion de session est de ne pas invalider la session existante apr√®s une connexion r√©ussie. Cela rend l'application vuln√©rable √† la fixation de session, o√π un attaquant peut imposer son ID de session √† la victime.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Code Vuln√©rable (Java Servlet)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Apr√®s une authentification r√©ussie</span>
<span class="keyword">public void</span> <span class="function">login</span>(HttpServletRequest request, ...) {
    <span class="comment">// ... logique d'authentification ...</span>
    SessionUser user = ...;
    
    <span class="comment">// ATTENTION: La session existante n'est PAS invalid√©e.
    // L'attaquant peut avoir fourni l'ID de session √† la victime.</span>
    request.getSession().setAttribute(<span class="string">"user"</span>, user);
}</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Code S√©curis√© (Java Servlet)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Apr√®s une authentification r√©ussie</span>
<span class="keyword">public void</span> <span class="function">login</span>(HttpServletRequest request, ...) {
    <span class="comment">// ... logique d'authentification ...</span>
    SessionUser user = ...;
    
    <span class="comment">// Invalider l'ancienne session pour pr√©venir la fixation de session</span>
    HttpSession oldSession = request.getSession(false);
    <span class="keyword">if</span> (oldSession != null) {
        oldSession.invalidate();
    }
    
    <span class="comment">// Cr√©er une nouvelle session pour l'utilisateur authentifi√©</span>
    HttpSession newSession = request.getSession(true);
    newSession.setAttribute(<span class="string">"user"</span>, user);
}</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Impl√©menter le MFA :</strong> Utilisez l'authentification multi-facteurs partout o√π c'est possible pour vous prot√©ger contre le credential stuffing et la force brute.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Politiques de mots de passe modernes :</strong> Appliquez des politiques de mot de passe bas√©es sur les directives du NIST 800-63b (longueur, complexit√©) et v√©rifiez les mots de passe par rapport √† des listes de mots de passe connus.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Prot√©ger contre l'√©num√©ration :</strong> Utilisez des messages g√©n√©riques pour les processus d'enregistrement et de r√©cup√©ration de mot de passe.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Limiter les tentatives de connexion :</strong> Mettez en place une limitation de d√©bit pour les tentatives de connexion √©chou√©es.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Gestion de session s√©curis√©e :</strong> Utilisez un gestionnaire de session c√¥t√© serveur qui g√©n√®re de nouveaux ID de session al√©atoires apr√®s la connexion et les invalide correctement √† la d√©connexion.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>La persistance des attaques par bourrage d'identifiants et des pratiques de mots de passe faibles est une pr√©occupation majeure. Un aspect pertinent est la contradiction entre s√©curit√© et convivialit√© : des exigences de mot de passe trop strictes peuvent encourager des comportements non s√©curis√©s. Cela souligne la n√©cessit√© de solutions qui √©quilibrent protection et exp√©rience utilisateur, comme le MFA. De plus, les d√©faillances de gestion de session, comme l'invalidation incorrecte des sessions c√¥t√© serveur, restent une faille courante mais critique, soulignant l'importance d'une gestion de session robuste et centralis√©e.</p>
                `,
            },
          },
        },
        A08: {
          id: "A08:2021",
          name: "D√©faillances d'Int√©grit√© Logicielle et de Donn√©es",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Il s'agit d'une nouvelle cat√©gorie qui se concentre sur les hypoth√®ses relatives aux mises √† jour logicielles, aux donn√©es critiques et aux pipelines CI/CD sans v√©rification de l'int√©grit√©. Elle inclut d√©sormais la "D√©s√©rialisation Non S√©curis√©e" de 2017. Cette vuln√©rabilit√© se produit lorsqu'une application s'appuie sur des plugins, des biblioth√®ques ou des modules provenant de sources, de d√©p√¥ts et de r√©seaux de distribution de contenu (CDN) non fiables, ou lorsque les mises √† jour ne sont pas v√©rifi√©es par une signature num√©rique.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Mises √† jour logicielles non sign√©es ou non v√©rifi√©es.</li>
                                <li>Pipelines CI/CD non s√©curis√©s.</li>
                                <li>D√©s√©rialisation de donn√©es provenant de sources non fiables.</li>
                                <li>Absence de v√©rification d'int√©grit√© sur les donn√©es entrantes.</li>
                                <li>T√©l√©chargement de code sans v√©rification d'int√©grit√©.</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Ex√©cution de code √† distance (RCE) et prise de contr√¥le du syst√®me.</li>
                                <li>Attaques sur la cha√Æne d'approvisionnement logicielle (ex: SolarWinds).</li>
                                <li>Alt√©ration du logiciel et injection de malwares.</li>
                                <li>Compromission de l'ensemble de l'infrastructure.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="mt-4 p-4 bg-gray-100 rounded-lg">
                        <h4 class="font-semibold">Exemple notoire : Attaque SolarWinds</h4>
                        <p class="text-sm mt-2">Des attaquants ont compromis le pipeline de build de SolarWinds pour injecter une porte d√©rob√©e dans les mises √† jour logicielles de leur produit Orion. Ces mises √† jour sign√©es et l√©gitimes ont ensuite √©t√© distribu√©es √† des milliers de clients, leur donnant un acc√®s sans pr√©c√©dent √† des r√©seaux gouvernementaux et d'entreprise hautement s√©curis√©s.</p>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">La d√©s√©rialisation non s√©curis√©e est un exemple majeur de cette cat√©gorie. Elle se produit lorsqu'une application d√©s√©rialise des objets provenant d'une source non fiable sans validation, ce qui peut conduire √† l'ex√©cution de code √† distance.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Code Vuln√©rable (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// D√©s√©rialisation d'un flux d'octets sans validation</span>
<span class="keyword">public Object</span> <span class="function">deserialize</span>(byte[] buffer) {
    ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(
        <span class="keyword">new</span> ByteArrayInputStream(buffer)
    );
    <span class="comment">// ATTENTION: readObject() peut ex√©cuter du code
    // si le buffer contient une "gadget chain" malveillante.</span>
    <span class="keyword">return</span> ois.readObject();
}</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Code S√©curis√© (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Utilisation d'une liste blanche pour restreindre les classes</span>
<span class="keyword">class</span> <span class="class-name">WhitelistedObjectInputStream</span> <span class="keyword">extends</span> ObjectInputStream {
    <span class="keyword">protected</span> Class&lt;?&gt; <span class="function">resolveClass</span>(ObjectStreamClass desc) {
        Set&lt;String&gt; whitelist = Set.of(<span class="string">"com.safe.User"</span>);
        <span class="keyword">if</span> (!whitelist.contains(desc.getName())) {
            <span class="keyword">throw new</span> InvalidClassException(<span class="string">"Classe non autoris√©e"</span>, desc.getName());
        }
        <span class="keyword">return super</span>.resolveClass(desc);
    }
}</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>V√©rifier les signatures :</strong> Utilisez des signatures num√©riques pour v√©rifier que les logiciels et les donn√©es proviennent de sources attendues et n'ont pas √©t√© alt√©r√©s.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>S√©curiser le pipeline CI/CD :</strong> Assurez une s√©gr√©gation, une configuration et un contr√¥le d'acc√®s appropri√©s pour garantir l'int√©grit√© du code.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser des d√©p√¥ts de confiance :</strong> Assurez-vous que les d√©pendances proviennent de d√©p√¥ts fiables. Envisagez un d√©p√¥t interne approuv√©.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Pr√©venir la d√©s√©rialisation non s√©curis√©e :</strong> √âvitez de d√©s√©rialiser des donn√©es de sources non fiables. Si c'est in√©vitable, utilisez des filtres de d√©s√©rialisation et une liste blanche de classes autoris√©es.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser des formats de donn√©es s√©curis√©s :</strong> Pr√©f√©rez des formats comme JSON qui ne sont pas ex√©cutables par nature.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>L'√©mergence de cette cat√©gorie refl√®te une prise de conscience des menaces complexes ciblant la cha√Æne d'approvisionnement. L'attaque SolarWinds a d√©montr√© comment la compromission d'un seul maillon peut avoir des cons√©quences d√©vastatrices. La s√©curit√© ne se limite plus au code de l'application, mais doit s'√©tendre √† l'ensemble du processus de d√©veloppement et de d√©ploiement. La d√©s√©rialisation non s√©curis√©e, en particulier, est une menace subtile mais puissante. Une approche proactive de la s√©curit√© de la cha√Æne d'approvisionnement, avec des signatures num√©riques et des contr√¥les d'int√©grit√©, est indispensable.</p>
                `,
            },
          },
        },
        A09: {
          id: "A09:2021",
          name: "D√©faillances de Journalisation et de Surveillance",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Cette cat√©gorie monte √† la 9√®me place et a √©t√© √©largie. Elle est cruciale car elle est le fondement de la d√©tection d'incidents, de l'alerte et de l'analyse forensique. Sans une journalisation et une surveillance ad√©quates, les br√®ches peuvent passer inaper√ßues pendant de longues p√©riodes, aggravant consid√©rablement les dommages. Une bonne journalisation est souvent la seule preuve d'une attaque.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>√âv√©nements auditables non journalis√©s (connexions, √©checs).</li>
                                <li>Messages d'erreur ou de log inad√©quats ou inexistants.</li>
                                <li>Journaux non surveill√©s pour les activit√©s suspectes.</li>
                                <li>Journaux stock√©s localement sans protection contre l'alt√©ration.</li>
                                <li>Seuils d'alerte inefficaces.</li>
                                <li>Journalisation de donn√©es sensibles (mots de passe, cartes de cr√©dit).</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>D√©tection tardive ou inexistante des br√®ches.</li>
                                <li>Incapacit√© √† d√©terminer la cause et l'√©tendue d'une attaque.</li>
                                <li>Difficult√© √† prouver la responsabilit√©.</li>
                                <li>Amendes r√©glementaires pour non-conformit√©.</li>
                                <li>Exposition de donn√©es sensibles via les journaux.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">Une erreur courante est de journaliser des informations sensibles directement dans les fichiers de log. Si ces logs sont compromis, cela conduit √† une fuite de donn√©es.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Code Vuln√©rable (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Journalisation de l'objet de requ√™te complet</span>
<span class="keyword">public void</span> <span class="function">processPayment</span>(HttpServletRequest request) {
    <span class="comment">// ATTENTION: La requ√™te peut contenir des mots de passe,
    // des num√©ros de carte de cr√©dit, des jetons de session, etc.</span>
    logger.info(<span class="string">"Requ√™te de paiement re√ßue: {}"</span>,
        new Gson().toJson(request.getParameterMap()));
}</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Code S√©curis√© (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Journalisation s√©lective et masquage des donn√©es</span>
<span class="keyword">public void</span> <span class="function">processPayment</span>(HttpServletRequest request) {
    String orderId = request.getParameter(<span class="string">"orderId"</span>);
    String userId = request.getParameter(<span class="string">"userId"</span>);
    String ccNumber = request.getParameter(<span class="string">"ccNumber"</span>);
    
    <span class="comment">// Journaliser uniquement les informations non sensibles
    // ou masqu√©es n√©cessaires √† l'audit.</span>
    logger.info(<span class="string">"Paiement pour commande {}, utilisateur {}, carte: {}"</span>,
        orderId, userId, maskCreditCard(ccNumber));
}</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Journaliser les √©v√©nements cl√©s :</strong> Assurez-vous que les connexions, les √©checs, les transactions de grande valeur et les √©checs de contr√¥le d'acc√®s sont journalis√©s avec un contexte suffisant.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>√âviter les donn√©es sensibles :</strong> Ne journalisez jamais de mots de passe, de num√©ros de carte de cr√©dit ou d'autres donn√©es sensibles. Masquez ou expurgez les donn√©es si n√©cessaire.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Prot√©ger les journaux :</strong> Assurez-vous que les journaux sont prot√©g√©s contre toute modification et qu'ils sont int√©gr√©s dans un syst√®me de gestion centralis√© (SIEM).</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Mettre en place des alertes :</strong> √âtablissez des alertes et des processus de r√©ponse efficaces pour les activit√©s suspectes d√©tect√©es dans les journaux.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Format structur√© :</strong> G√©n√©rez des journaux dans un format structur√© (ex: JSON) pour faciliter leur consommation par des outils automatis√©s.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>Cette cat√©gorie est souvent n√©glig√©e car elle ne repr√©sente pas une vuln√©rabilit√© exploitable directement. Cependant, son absence transforme des incidents mineurs en br√®ches majeures. L'un des plus grands d√©fis est le volume de donn√©es : trop de logs peuvent √™tre aussi inutiles que pas assez s'ils ne sont pas correctement filtr√©s et analys√©s. Une strat√©gie de journalisation bien d√©finie, ax√©e sur les √©v√©nements de s√©curit√© critiques et int√©gr√©e √† un SIEM avec des alertes pertinentes, est fondamentale pour une posture de s√©curit√© mature.</p>
                `,
            },
          },
        },
        A10: {
          id: "A10:2021",
          name: "Falsification de Requ√™te C√¥t√© Serveur (SSRF)",
          tabs: {
            overview: {
              title: "Vue d'ensemble",
              content: `
                    <p class="mb-4">Le SSRF est une nouvelle cat√©gorie qui entre directement dans le Top 10. Les failles SSRF se produisent lorsqu'une application web r√©cup√®re une ressource distante sans valider l'URL fournie par l'utilisateur. Elle permet √† un attaquant de forcer l'application √† envoyer une requ√™te √©labor√©e √† une destination inattendue, m√™me lorsque l'application est prot√©g√©e par un pare-feu ou un VPN. La pr√©valence de cette attaque a augment√© avec la popularit√© des architectures cloud et des microservices.</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-red-800">Causes Courantes</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Validation d'entr√©e insuffisante sur l'URL fournie par l'utilisateur.</li>
                                <li>Listes de blocage (blacklists) ou expressions r√©guli√®res facilement contournables.</li>
                                <li>Confiance excessive dans les services internes.</li>
                                <li>Fonctionnalit√©s permettant de r√©cup√©rer des ressources via URL (webhooks, importateurs de documents).</li>
                            </ul>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <h4 class="font-semibold text-yellow-800">Impacts M√©tier</h4>
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Scan des ports et des r√©seaux internes.</li>
                                <li>Exfiltration de donn√©es sensibles et de m√©tadonn√©es cloud.</li>
                                <li>Interaction avec des services internes non expos√©s publiquement.</li>
                                <li>Ex√©cution de code √† distance sur des syst√®mes internes.</li>
                            </ul>
                        </div>
                    </div>
                `,
            },
            code: {
              title: "Exemples de Code",
              content: `
                    <p class="mb-4">Une faille SSRF se produit lorsqu'une application utilise une URL fournie par un utilisateur pour faire une requ√™te c√¥t√© serveur sans la valider correctement.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2 text-red-700">üî¥ Code Vuln√©rable (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// L'application r√©cup√®re le contenu d'une URL fournie par l'utilisateur</span>
<span class="keyword">public String</span> <span class="function">fetchUrlContent</span>(String urlString) {
    URL url = <span class="keyword">new</span> URL(urlString);
    <span class="comment">// ATTENTION: Pas de validation de 'urlString'.
    // Un attaquant peut fournir une URL interne comme:
    // "http://169.254.169.254/latest/meta-data/" (m√©tadonn√©es AWS)
    // ou "file:///etc/passwd"</span>
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();
    <span class="comment">// ... lire et retourner le contenu ...</span>
}</code></pre>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2 text-green-700">üü¢ Code S√©curis√© (Java)</h4>
                            <div class="code-block">
                                <pre><code><span class="comment">// Impl√©mentation d'une liste blanche d'h√¥tes et de protocoles</span>
<span class="keyword">public String</span> <span class="function">fetchUrlContent</span>(String urlString) {
    URL url = <span class="keyword">new</span> URL(urlString);
    
    <span class="comment">// V√âRIFICATION: Appliquer une liste blanche stricte</span>
    String host = url.getHost();
    String protocol = url.getProtocol();
    <span class="keyword">if</span> (!protocol.equals(<span class="string">"https"</span>) || !isAllowedHost(host)) {
        <span class="keyword">throw new</span> SecurityException(<span class="string">"H√¥te ou protocole non autoris√©"</span>);
    }
    
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();
    <span class="comment">// ... lire et retourner le contenu ...</span>
}</code></pre>
                            </div>
                        </div>
                    </div>
                `,
            },
            mitigation: {
              title: "Strat√©gies de Mitigation",
              content: `
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Segmentation du r√©seau :</strong> Isolez le syst√®me qui effectue les requ√™tes distantes pour limiter l'impact en cas de compromission.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Appliquer une liste blanche :</strong> C√¥t√© application, validez toutes les entr√©es utilisateur et appliquez une liste blanche stricte de protocoles, de domaines et de ports autoris√©s.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>D√©sactiver les redirections HTTP :</strong> Emp√™chez l'application de suivre les redirections pour √©viter les contournements.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Ne pas exposer les r√©ponses brutes :</strong> Ne renvoyez jamais la r√©ponse brute du serveur distant √† l'utilisateur, car elle pourrait contenir des informations sensibles.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 text-xl">‚úÖ</span><span><strong>Utiliser des pare-feu :</strong> Appliquez une politique de "refus par d√©faut" au niveau du pare-feu pour bloquer tout trafic sortant non essentiel.</span></li>
                    </ul>
                `,
            },
            analysis: {
              title: "Analyse Approfondie",
              content: `
                    <p>L'inclusion du SSRF dans le Top 10 est une r√©ponse directe √† la mont√©e en puissance des architectures cloud et des microservices. Dans ces environnements, les applications interagissent constamment avec d'autres services internes, et les fronti√®res de confiance sont plus floues. Le SSRF exploite cette connectivit√©. La mitigation repose sur une d√©fense en profondeur : la validation stricte des entr√©es c√¥t√© application (liste blanche, pas liste noire) doit √™tre compl√©t√©e par une segmentation rigoureuse du r√©seau pour limiter ce qu'un serveur compromis peut atteindre.</p>
                `,
            },
          },
        },
      };

      document.addEventListener("DOMContentLoaded", () => {
        const nav = document.getElementById("main-nav");
        const content = document.getElementById("main-content");
        let activeChart = null;
        let activeNavItem = null;

        const navItems = [
          { id: "introduction", name: "üè† Introduction" },
          { id: "evolution", name: "üìà √âvolution 2017-2021" },
          ...Object.keys(owaspData)
            .filter((key) => key.startsWith("A"))
            .sort((a, b) => parseInt(a.substring(1)) - parseInt(b.substring(1)))
            .map((key) => ({
              id: key,
              name: `${owaspData[key].id.split(":")[0]}: ${
                owaspData[key].name
              }`,
            })),
        ];

        function renderNav() {
          navItems.forEach((item) => {
            const link = document.createElement("a");
            link.href = "#";
            link.dataset.id = item.id;
            link.className =
              "nav-link block p-2 rounded-md text-gray-600 font-medium text-sm";
            link.innerHTML = item.name;
            link.onclick = (e) => {
              e.preventDefault();
              navigateTo(item.id);
            };
            nav.appendChild(link);
          });
        }

        function navigateTo(id) {
          if (activeChart) {
            activeChart.destroy();
            activeChart = null;
          }

          const data = owaspData[id];
          content.innerHTML = "";
          content.classList.add("content-fade-in");

          const newActiveNavItem = nav.querySelector(`[data-id="${id}"]`);
          if (activeNavItem) {
            activeNavItem.classList.remove("active");
          }
          if (newActiveNavItem) {
            newActiveNavItem.classList.add("active");
            activeNavItem = newActiveNavItem;
          }

          const title = document.createElement("h2");
          title.className = "text-3xl font-bold text-gray-800 mb-2";
          title.textContent = data.title || `${data.id}: ${data.name}`;
          content.appendChild(title);

          if (data.tabs) {
            renderTabs(data.tabs);
          } else {
            const contentDiv = document.createElement("div");
            contentDiv.innerHTML = data.content;
            content.appendChild(contentDiv);
            if (id === "evolution") {
              createEvolutionChart();
            }
          }

          setTimeout(() => content.classList.remove("content-fade-in"), 500);
        }

        function renderTabs(tabsData) {
          const tabContainer = document.createElement("div");
          tabContainer.className = "flex border-b border-gray-200 mb-6";
          const tabContentContainer = document.createElement("div");

          const tabIds = Object.keys(tabsData);

          tabIds.forEach((tabId) => {
            const button = document.createElement("button");
            button.className =
              "tab-button py-2 px-4 text-gray-500 font-semibold";
            button.textContent = tabsData[tabId].title;
            button.onclick = () => {
              tabContainer
                .querySelectorAll(".tab-button")
                .forEach((btn) => btn.classList.remove("active"));
              button.classList.add("active");
              tabContentContainer.innerHTML = tabsData[tabId].content;
            };
            tabContainer.appendChild(button);
          });

          content.appendChild(tabContainer);
          content.appendChild(tabContentContainer);

          tabContainer.querySelector(".tab-button").click();
        }

        function createEvolutionChart() {
          const ctx = document
            .getElementById("evolutionChart")
            .getContext("2d");
          if (!ctx) return;

          const data = {
            labels: [
              "A01: Contr√¥le d'Acc√®s D√©faillant",
              "A02: D√©faillances Cryptographiques",
              "A03: Injection",
              "A04: Conception Dangereuse",
              "A05: Mauvaise Config. de S√©curit√©",
              "A06: Composants Vuln√©rables",
              "A07: D√©faillances d'Authentification",
              "A08: D√©faillances d'Int√©grit√©",
              "A09: D√©faillances de Journalisation",
              "A10: SSRF",
            ],
            datasets: [
              {
                label: "Rang 2017",
                data: [5, 3, 1, null, 6, 9, 2, 8, 10, null],
                backgroundColor: "rgba(156, 163, 175, 0.6)",
                borderColor: "rgba(156, 163, 175, 1)",
                borderWidth: 1,
                barPercentage: 0.6,
              },
              {
                label: "Rang 2021",
                data: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
                backgroundColor: "rgba(96, 165, 250, 0.6)",
                borderColor: "rgba(96, 165, 250, 1)",
                borderWidth: 1,
                barPercentage: 0.6,
              },
            ],
          };

          const notes = [
            "2017: A5 -> 2021: A1 (Mont√©e)",
            "2017: A3 (Expo. Donn√©es Sensibles) -> 2021: A2 (Renomm√©e/Mont√©e)",
            "2017: A1 & A7 (XSS) -> 2021: A3 (Consolid√©e/Descendue)",
            "Nouvelle cat√©gorie en 2021",
            "2017: A6 & A4 (XXE) -> 2021: A5 (Consolid√©e/Mont√©e)",
            "2017: A9 -> 2021: A6 (Renomm√©e/Mont√©e)",
            "2017: A2 -> 2021: A7 (Renomm√©e/Descendue)",
            "2017: A8 (D√©s√©rialisation) -> 2021: A8 (Nouvelle/Consolid√©e)",
            "2017: A10 -> 2021: A9 (Renomm√©e/Mont√©e)",
            "Nouvelle cat√©gorie en 2021",
          ];

          activeChart = new Chart(ctx, {
            type: "bar",
            data: data,
            options: {
              indexAxis: "y",
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                x: {
                  beginAtZero: true,
                  reverse: true,
                  title: {
                    display: true,
                    text: "Classement (1 = Plus critique)",
                  },
                },
                y: {
                  ticks: {
                    font: {
                      size: 10,
                    },
                  },
                },
              },
              plugins: {
                legend: {
                  position: "top",
                },
                tooltip: {
                  callbacks: {
                    afterLabel: function (context) {
                      return notes[context.dataIndex] || "";
                    },
                  },
                },
                title: {
                  display: true,
                  text: "Comparaison des classements OWASP Top 10: 2017 vs 2021",
                  font: {
                    size: 16,
                  },
                },
              },
            },
          });
        }

        renderNav();
        navigateTo("introduction");
      });
    </script>
  </body>
</html>
